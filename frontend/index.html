<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>会议记录生成器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .input-section {
            margin-bottom: 30px;
        }
        
        .input-section label {
            display: block;
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            resize: vertical;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }
        
        textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        button {
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #7f8c8d, #95a5a6);
            color: white;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(127, 140, 141, 0.3);
        }
        
        .btn-download {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }
        
        .btn-download:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #7f8c8d;
        }
        
        .loading.spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .result-section {
            display: none;
            margin-top: 30px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 5px solid #3498db;
        }
        
        .result-section h3 {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .result-content {
            line-height: 1.8;
            color: #34495e;
        }
        
        .result-content p {
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 2px solid #ecf0f1;
        }
        
        .result-content strong {
            color: #2c3e50;
        }
        
        .raw-content {
            background-color: #000;
            color: #0f0;
            font-family: monospace;
            font-size: 12px;
            padding: 15px;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-all;
            margin-top: 15px;
        }
        
        .error-section {
            display: none;
            padding: 20px;
            background: #ffeaea;
            border-radius: 8px;
            border-left: 5px solid #e74c3c;
            color: #c0392b;
            margin-top: 20px;
        }
        
        .footer {
            background: #34495e;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 14px;
        }
        
        .example-section {
            margin-top: 30px;
            padding: 20px;
            background: #f0f8ff;
            border-radius: 8px;
            border-left: 5px solid #6495ed;
        }
        
        .example-section h4 {
            color: #1a5276;
            margin-bottom: 15px;
        }
        
        .example-content {
            font-size: 14px;
            color: #2874a6;
            line-height: 1.6;
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            background: white;
            border-radius: 4px;
            border: 1px solid #d4e6f1;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>会议记录生成器</h1>
            <p>智能提取会议信息，一键生成专业会议记录文档</p>
        </div>
        
        <div class="content">
            <div class="input-section">
                <label for="meeting-text">请输入会议内容描述：</label>
                <textarea id="meeting-text" placeholder="例如：下周三下午三点，我想在公司三楼的大会议室开个会，参会的有市场部的李明、张娜..."></textarea>
            </div>
            
            <div class="button-group">
                <button id="extract-btn" class="btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m21 11-6-6-6 6 6 6 6-6z"></path>
                        <path d="m3 12 9-9 9 9"></path>
                        <path d="M12 3v18"></path>
                    </svg>
                    提取会议信息
                </button>
                <button id="generate-btn" class="btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" x2="8" y1="13" y2="13"></line>
                        <line x1="16" x2="8" y1="17" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    生成文档
                </button>
                <button id="clear-btn" class="btn-secondary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 6h18"></path>
                        <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                        <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                        <line x1="10" x2="10" y1="11" y2="17"></line>
                        <line x1="14" x2="14" y1="11" y2="17"></line>
                    </svg>
                    清空输入
                </button>
            </div>
            
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>正在处理中，请稍候...</p>
            </div>
            
            <div id="result" class="result-section">
                <h3>提取的会议信息</h3>
                <div id="result-content" class="result-content">
                    <!-- 结果将在这里显示 -->
                </div>
                <div style="margin-top: 20px;">
                    <button id="download-btn" class="btn-download">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" x2="12" y1="15" y2="3"></line>
                        </svg>
                        下载Word文档
                    </button>
                </div>
            </div>
            <div id="raw-result" class="result-section">
                <h3>原始响应（调试信息）</h3>
                <div id="raw-response" class="raw-content">
                    <!-- 这里将显示原始响应 -->
                </div>
            </div>
            
            <div id="error" class="error-section">
                <strong>错误：</strong>
                <span id="error-message"></span>
            </div>
            
            <div class="example-section">
                <h4>输入示例：</h4>
                <div class="example-content">
                    下周三下午三点，我想在公司三楼的大会议室开个会，参会的有市场部的李明、张娜，技术部的王磊，还有新来的实习生赵晓雨。会议主要说三件事，一是讨论下季度的产品推广方案，特别是线上广告投放的预算分配，李明你准备下相关数据；二是同步下新版APP的研发进度，王磊负责这块；三是安排下月底的团建活动，张娜你牵头，大家看看想去近郊的民宿还是去爬山，赵晓雨可以多听听大家的意见。对了，会议大概开两个小时，记得提前把会议资料发到群里。
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>会议记录生成器 © 2024 | 基于AI技术打造</p>
        </div>
    </div>
    
    <script>
        const API_BASE_URL = 'http://127.0.0.1:5000';
        const meetingText = document.getElementById('meeting-text');
        const extractBtn = document.getElementById('extract-btn');
        const generateBtn = document.getElementById('generate-btn');
        const clearBtn = document.getElementById('clear-btn');
        const downloadBtn = document.getElementById('download-btn');
        const loading = document.getElementById('loading');
        const result = document.getElementById('result');
        const resultContent = document.getElementById('result-content');
        const error = document.getElementById('error');
        const errorMessage = document.getElementById('error-message');
        
        // 显示加载状态
        function showLoading() {
            loading.style.display = 'block';
            result.style.display = 'none';
            error.style.display = 'none';
        }
        
        // 显示错误信息
        function showError(message) {
            loading.style.display = 'none';
            errorMessage.textContent = message;
            error.style.display = 'block';
            result.style.display = 'none';
            const rawResult = document.getElementById('raw-result');
            const rawResponse = document.getElementById('raw-response');
            if (rawResult && rawResponse) {
                rawResult.style.display = 'block';
                rawResponse.textContent = `错误: ${message}`;
            }
        }
        
        // 显示结果
        function showResult(data) {
            loading.style.display = 'none';
            error.style.display = 'none';
            result.style.display = 'block';
            const rawResult = document.getElementById('raw-result');
            const rawResponse = document.getElementById('raw-response');
            rawResult.style.display = 'block';
            
            // 构建结果HTML
            let html = `
                <p><strong>会议主题：</strong>${data.theme || '未指定'}</p>
                <p><strong>主持人：</strong>${data.host || '未指定'}</p>
                <p><strong>会议地点：</strong>${data.location || '未指定'}</p>
                <p><strong>参会人员：</strong>${data.attendees || '未指定'}</p>
                <p><strong>会议时长：</strong>${data.duration || '未指定'}</p>
            `;
            
            if (data.topics && data.topics.length > 0) {
                html += '<h4>会议议题：</h4>';
                data.topics.forEach((topic, index) => {
                    html += `
                        <div style="margin-left: 20px; margin-bottom: 15px;">
                            <p><strong>议题${index + 1}：</strong>${topic.topic}</p>
                            <p><strong>负责人：</strong>${topic.leader || '未指定'}</p>
                            <p><strong>会前准备：</strong>${topic.preparation || '无'}</p>
                        </div>
                    `;
                });
            }
            
            resultContent.innerHTML = html;
            // 显示原始响应用于调试
            rawResponse.textContent = JSON.stringify(data, null, 2) || '无原始响应';
        }
        
        // 提取会议信息
        async function extractMeetingInfo() {
            const text = meetingText.value.trim();
            if (!text) {
                showError('请输入会议内容描述');
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch(`${API_BASE_URL}/extract`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ text })
                });
                
                if (!response.ok) {
                    throw new Error('服务器响应异常');
                }
                
                const data = await response.json();
                if (data.success) {
                    showResult(data.data);
                } else {
                    showError('提取失败，请检查输入内容');
                }
            } catch (err) {
                showError('网络错误或服务器未启动，请确保后端服务正常运行');
                console.error('提取会议信息失败:', err);
            }
        }
        
        // 生成并下载文档
        async function generateAndDownload() {
            const text = meetingText.value.trim();
            if (!text) {
                showError('请输入会议内容描述');
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch(`${API_BASE_URL}/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ text })
                });
                
                if (!response.ok) {
                    throw new Error('文档生成失败');
                }
                
                // 处理文件下载
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `meeting_${new Date().toISOString().slice(0, 10)}.docx`;
                document.body.appendChild(a);
                a.click();
                a.remove();
                window.URL.revokeObjectURL(url);
                
                loading.style.display = 'none';
                alert('文档下载成功！');
            } catch (err) {
                showError('文档生成失败，请检查后端服务是否正常运行');
                console.error('生成文档失败:', err);
            }
        }
        
        // 清空输入
        function clearInput() {
            meetingText.value = '';
            result.style.display = 'none';
            error.style.display = 'none';
        }
        
        // 事件监听
        extractBtn.addEventListener('click', extractMeetingInfo);
        generateBtn.addEventListener('click', generateAndDownload);
        downloadBtn.addEventListener('click', generateAndDownload);
        clearBtn.addEventListener('click', clearInput);
        
        // 键盘快捷键
        meetingText.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'Enter') {
                extractMeetingInfo();
            }
        });
        
        // 初始化时检查后端服务
        async function checkBackend() {
            try {
                const response = await fetch(`${API_BASE_URL}/health`);
                if (!response.ok) {
                    console.warn('后端服务可能未启动');
                }
            } catch (err) {
                console.warn('无法连接到后端服务:', err);
            }
        }
        
        // 页面加载时检查后端服务
        checkBackend();
    </script>
</body>
</html>